<div class="dashboard-container">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h3 mb-0 text-gradient">Admin Dashboard</h1>
      <p class="text-muted mb-0">Welcome back, {{ currentAdmin?.name }}!</p>
    </div>
    <button 
      class="btn btn-outline-primary"
      (click)="refreshData()"
      [disabled]="isLoading"
    >
      <i class="fas fa-sync-alt" [class.fa-spin]="isLoading"></i>
      Refresh
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading dashboard data...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading">
    <!-- Stats Cards -->
    <div class="row g-4 mb-4">
      <!-- ðŸ“š Books Card - ADD CLICK HANDLER -->
      <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="stats-card bg-primary" style="cursor: pointer;" (click)="navigateToBooks()">
          <div class="stats-icon">
            <i class="fas fa-book"></i>
          </div>
          <div class="stats-content">
            <h3>{{ dashboardStats?.totalBooks || 0 }}</h3>
            <p>Total Books</p>
            <small class="text-light">
              <i class="fas fa-arrow-up me-1"></i>
              {{ dashboardStats?.monthlyStats?.booksAdded || 0 }} this month
            </small>
          </div>
        </div>
      </div>

      <!-- ðŸ‘¥ Members Card - ADD CLICK HANDLER -->
      <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="stats-card bg-success" style="cursor: pointer;" (click)="navigateToMembers()">
          <div class="stats-icon">
            <i class="fas fa-users"></i>
          </div>
          <div class="stats-content">
            <h3>{{ dashboardStats?.totalMembers || 0 }}</h3>
            <p>Total Members</p>
            <small class="text-light">
              <i class="fas fa-arrow-up me-1"></i>
              {{ dashboardStats?.monthlyStats?.newMembers || 0 }} this month
            </small>
          </div>
        </div>
      </div>

      <!-- ðŸ“– Borrowed Books Card - ADD CLICK HANDLER -->
      <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="stats-card bg-warning" style="cursor: pointer;" (click)="navigateToBooks()">
          <div class="stats-icon">
            <i class="fas fa-book-reader"></i>
          </div>
          <div class="stats-content">
            <h3>{{ dashboardStats?.totalBorrowedBooks || 0 }}</h3>
            <p>Borrowed Books</p>
            <small class="text-dark">
              <i class="fas fa-exclamation-triangle me-1"></i>
              {{ dashboardStats?.overdueBooks || 0 }} overdue
            </small>
          </div>
        </div>
      </div>

      <!-- ðŸ“ž Complaints Card - ADD CLICK HANDLER -->
      <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="stats-card bg-danger" style="cursor: pointer;" (click)="navigateToComplaints()">
          <div class="stats-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="stats-content">
            <h3>{{ dashboardStats?.totalComplaints || 0 }}</h3>
            <p>Total Complaints</p>
            <small class="text-light">
              <i class="fas fa-clock me-1"></i>
              {{ dashboardStats?.pendingComplaints || 0 }} pending
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="row g-4 mb-4">
      <div class="col-lg-8">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">
              <i class="fas fa-tachometer-alt me-2"></i>
              Quick Actions
            </h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <!-- ðŸ“š Add Book - CHANGE TO CLICK HANDLER -->
              <div class="col-md-6">
                <div class="quick-action-card" style="cursor: pointer;" (click)="navigateToBookManagement()">
                  <i class="fas fa-plus-circle"></i>
                  <div>
                    <h6>Add New Book</h6>
                    <p>Add books to library</p>
                  </div>
                </div>
              </div>
              
              <!-- ðŸ‘¥ Manage Members - CHANGE TO CLICK HANDLER -->
              <div class="col-md-6">
                <div class="quick-action-card" style="cursor: pointer;" (click)="navigateToMembers()">
                  <i class="fas fa-users"></i>
                  <div>
                    <h6>Manage Members</h6>
                    <p>View member details</p>
                  </div>
                </div>
              </div>
              
              <!-- â¤ï¸ Review Donations - CHANGE TO CLICK HANDLER -->
              <div class="col-md-6">
                <div class="quick-action-card" style="cursor: pointer;" (click)="navigateToPendingDonations()">
                  <i class="fas fa-heart"></i>
                  <div>
                    <h6>Review Donations</h6>
                    <p>{{ dashboardStats?.pendingDonations || 0 }} pending</p>
                  </div>
                </div>
              </div>
              
              <!-- ðŸ“ž Handle Complaints - CHANGE TO CLICK HANDLER -->
              <div class="col-md-6">
                <div class="quick-action-card" style="cursor: pointer;" (click)="navigateToComplaints()">
                  <i class="fas fa-headset"></i>
                  <div>
                    <h6>Handle Complaints</h6>
                    <p>{{ dashboardStats?.pendingComplaints || 0 }} pending</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">
              <i class="fas fa-chart-pie me-2"></i>
              System Overview
            </h5>
          </div>
          <div class="card-body">
            <div class="system-metric">
              <div class="metric-label">Available Books</div>
              <div class="metric-value text-success">
                {{ (dashboardStats?.totalBooks || 0) - (dashboardStats?.totalBorrowedBooks || 0) }}
              </div>
            </div>
            <div class="system-metric">
              <div class="metric-label">Total Fines</div>
              <div class="metric-value text-warning">
                â‚¹{{ dashboardStats?.totalFines || 0 }}
              </div>
            </div>
            <div class="system-metric">
              <div class="metric-label">Active Members</div>
              <div class="metric-value text-info">
                {{ dashboardStats?.totalMembers || 0 }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Activities -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="card-title mb-0">
              <i class="fas fa-history me-2"></i>
              Recent Activities
            </h5>
            <a routerLink="/admin/reports" class="btn btn-sm btn-outline-primary">
              View All Reports
            </a>
          </div>
          <div class="card-body">
            <div *ngIf="recentActivities && recentActivities.length > 0; else noActivities">
              <div 
                *ngFor="let activity of recentActivities" 
                class="activity-item"
              >
                <div class="activity-icon" [ngClass]="getActivityIconClass(activity.type)">
                  <i [class]="getActivityIcon(activity.type)"></i>
                </div>
                <div class="activity-content">
                  <div class="activity-description">{{ activity.description }}</div>
                  <div class="activity-time text-muted">
                    <i class="fas fa-clock me-1"></i>
                    {{ formatDate(activity.timestamp) }}
                  </div>
                </div>
              </div>
            </div>
            <ng-template #noActivities>
              <div class="text-center py-4">
                <i class="fas fa-inbox fa-2x text-muted mb-3"></i>
                <p class="text-muted">No recent activities</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
